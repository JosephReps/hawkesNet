{{< include _setup.qmd >}}

```{=html}
<style>
/* --- Workflow pipeline card --- */
.pipeline-card{
  max-width: 820px;
  margin: 1rem auto 1.2rem auto;
  padding: 0.9rem 1rem;
  border: 1px solid rgba(255,255,255,0.12);
  border-radius: 14px;
  background: rgba(255,255,255,0.04);
}
.pipeline-row{
  display: grid;
  grid-template-columns: 1fr auto 1fr auto 1fr;
  gap: 0.9rem;
  align-items: center;
}
.pipeline-step{
  padding: 0.65rem 0.75rem;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,0.12);
  background: rgba(0,0,0,0.10);
}
.pipeline-title{
  font-weight: 700;
  letter-spacing: -0.01em;
  margin-bottom: 0.25rem;
}
.pipeline-sub{
  font-size: 0.85rem;
  line-height: 1.25;
  color: #9aa0a6;
}
.pipeline-arrow{
  font-size: 1.15rem;
  color: #9aa0a6;
  user-select: none;
}
.pipeline-code{
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  font-size: 0.82rem;
  color: rgba(255,255,255,0.86);
  margin-top: 0.35rem;
}
@media (max-width: 860px){
  .pipeline-row{ grid-template-columns: 1fr; }
  .pipeline-arrow{ display:none; }
}
</style>
```

# Package Structure

The core flow is:

```{=html}
<div class="pipeline-card">
  <div class="pipeline-row">
    <div class="pipeline-step">
      <div class="pipeline-title">Input data</div>
      <div class="pipeline-sub">Two data frames: node arrivals + edge arrivals.</div>
      <div class="pipeline-code">nodes(id, time, …)<br/>edges(i, j, time, …)</div>
    </div>

    <div class="pipeline-arrow">→</div>

    <div class="pipeline-step">
      <div class="pipeline-title">make_events()</div>
      <div class="pipeline-sub">Normalises times and builds event-indexed tables.</div>
      <div class="pipeline-code">times<br/>nodes<br/>edges</div>
    </div>

    <div class="pipeline-arrow">→</div>

    <div class="pipeline-step">
      <div class="pipeline-title">fit_hawkesNet()</div>
      <div class="pipeline-sub">Choose a kernel (BA / CS / bipartite) and fit.</div>
      <div class="pipeline-code">fit$par<br/>plot(fit)</div>
    </div>
  </div>
</div>
```

## What goes where?

- **This page**: big-picture workflow and “how to think about the package”.
- **Events page**: the exact data-frame specs and the `events` object structure
  (see the dedicated *Events* chapter for full details).

## Minimal workflow

```{r eval = FALSE}
# 1) Provide nodes + edges as data frames
nodes <- data.frame(id = 1:10, time = 0:9)
edges <- data.frame(
  i = c(1,1,3,4,4,5,3,7,6,8),
  j = c(2,3,2,1,2,1,6,2,5,1),
  time = 2:11
)

# 2) Convert to an events object
ev <- make_events(nodes = nodes, edges = edges)

# 3) Fit a kernel
fit <- fit_hawkesNet(
  ev = ev,
  params_init = list(mu = 1, K = 1, beta = 1, beta_edges = 1),
  mark_type = "ba"
)

plot(fit)
```

::: {.callout-note collapse="true"}
## Why events-first?

- Data frames are easier to validate, transform, and keep aligned with your
  “real” dataset than mutating a `network` object directly.
- `make_events()` gives you an inspectable, stable intermediate representation
  that is used throughout simulation + fitting.
- For large fits, the likelihood is implemented to build the network once and
  then reuse cached structures during optimisation.
:::
