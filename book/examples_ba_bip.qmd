{{< include _setup.qmd >}}

# BA-Bipartite Kernel

### Kernel Specification {.unnumbered}

Nodes have two possible classifications / types / modes - events / perps.

Each mark consists of exactly 1 new event node arriving, which connects to old 
perp nodes according to the same degree-based weighting above. Additionally, 
each mark consists of n ~ Pois(lambda_new) perp nodes, which are attached to the 
new event node.

### Simulation {.unnumbered}

Simulate BIP-BA data.

<div class="vcenter-cols">
::: {.columns}
::: {.column width="40%"}

```{r}
set.seed(1)

time <- 10
params_bip_true <- list(
  mu = 0.5,
  K = 0.5,
  beta = 0.5,
  beta_edges = 2,
  lambda_new = 3.5
)

sim <- sim_hawkesNet(
  params = params_bip_true,
  T_end = time,
  mark_type = "ba_bip"
)
```

:::
::: {.column width="60%"}

```{r fig.width=8, fig.height=8, out.width="100%", echo = FALSE}
col_map <- c(
  event = "#377EB8",
  perp  = "#E41A1C"
)

roles <- network::get.vertex.attribute(sim$net, "role")
cols <- col_map[roles]

op <- par(no.readonly = TRUE)
on.exit(par(op), add = TRUE)

# Add a little bottom space for legend
par(mar = c(2.5,1,1,1), xaxs = "i", yaxs = "i")

plot(sim$net, vertex.col = cols)

legend(
  "bottomleft",
  legend = c("Event", "Perp"),
  pch = 21,
  pt.bg = col_map[c("event", "perp")],  # fill colour
  col = "black",                        # border colour
  horiz = TRUE,
  inset = 0.01,
  xpd = TRUE,
  cex = 2,
  pt.cex = 2.5
)
```

:::
:::
</div>

### Model fitting {.unnumbered}

Fit BIP-BA data.

```{r}
params_bip_init <- list(
  mu = 1,
  K = 1,
  beta = 1,
  beta_edges = 1,
  lambda_new = 3.5
)

fit <- fit_hawkesNet(
      ev = sim$ev,
      params_init = params_bip_init,
      mark_type = "ba_bip"
    )
```

Parameter values on the fitted scale:

```{r}
unlist(fit$par)
```

Parameter values on the transformed scale:

```{r}
fit$fit$par
```

::: {.callout-note collapse="true"}
## See the simulation study results for the BA-BIP kernel here.
:::



