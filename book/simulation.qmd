{{< include _setup.qmd >}}

# Simulation

Simulation is relatively straightforward for the core kernels (BA, BA_BIP, CS, BIP_CS).

Uses the usual hawkes Ogata thinning algorithm.

## Example {.unnumbered}

Simulate data using the `sim_hawkesNet()` function. See `?hawkesNet::sim_hawkesNet` 
for more information.

```{r}
set.seed(1)

params_ba <- list(
  mu = 5,
  K = 0.5,
  beta = 0.8,
  beta_edges = 0.5
)

time <- 10

sim <- sim_hawkesNet(
  params = params_ba,
  T_end = time,
  return_ev = TRUE,
  debug = FALSE,
  mark_type = "ba"
)
```

## Return value {.unnumbered}

Simulation object contains `events`, `accept_probs`, `net` and `ev`.

### `events` {.unnumbered} 

Contains the times and number of total events simulated:

```{r}
str(sim$events)
```

### `accept_probs` {.unnumbered}

Contains the acceptance probabilities from the thinning for each 
event:

```{r}
str(sim$accept_probs)
```

### `net` {.unnumbered}

The final network created from the events:

```{r figure.caption = "Realisation of a BA simulation"}
plot(sim$net)
```

Notice that the `time` attributes are preserved in the network object:

```{r}
sim$net
```

:::callout-tip
All the vertex attributes are preserved. Additionally, edge 
attributes are supported, so if custom kernels are written which utilize 
these later i.e. weighted edges, toggle-able edges etc., the current framework
does not eed to change.
:::

### `ev` {.unnumbered}

The `events` object which can be plugged directly into `fit_hawkesNet()`.

```{r}
str(sim$ev)
```











