% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_hawkesNet.R
\name{fit_hawkesNet}
\alias{fit_hawkesNet}
\title{Fit a HawkesNet model by maximum likelihood}
\usage{
fit_hawkesNet(
  events,
  params_init,
  fixed_params = NULL,
  transform = NULL,
  hessian = FALSE,
  control = list(),
  mark_type = "ba",
  debug = FALSE,
  T_end = NULL,
  T0 = 0,
  formula_rhs = NULL,
  ...
)
}
\arguments{
\item{events}{An events object created by \code{make_events()}.}

\item{params_init}{Named list of starting values for all model parameters.
Must include the parameters required by the chosen \code{mark_type} (and any
baseline/intensity parameters used by \code{loglik()}).}

\item{fixed_params}{Character vector of parameter names to hold fixed at
their \code{params_init} values.}

\item{transform}{Named character vector giving the working-scale transform
for each parameter in \code{params_init} (e.g. \code{"log"}). Missing entries default
to \code{"log"}. If \code{NULL}, all parameters default to \code{"log"}.}

\item{hessian}{Logical; if \code{TRUE}, return the Hessian from \code{optim()}.}

\item{control}{List of control arguments passed to \code{\link[stats:optim]{stats::optim()}}.}

\item{mark_type}{One of \code{"ba"}, \code{"cs"}, \code{"ba_bip"}, \code{"cs_bip"}.}

\item{debug}{Logical; enable debug mode (passed through to likelihood/mark
components where supported).}

\item{T_end}{Optional end time for the likelihood window.}

\item{T0}{Start time for the likelihood window.}

\item{formula_rhs}{}

\item{...}{Additional arguments forwarded to the mark PMF / edge-probability
functions used inside \code{loglik()}.}
}
\value{
A list with components:
\describe{
\item{fit}{The \code{optim()} result (or \code{NULL} if all parameters are fixed).}
\item{par}{Named list of parameter estimates on the natural scale.}
\item{loglik}{Log-likelihood at \code{par}.}
\item{convergence}{\code{optim()} convergence code.}
\item{message}{\code{optim()} message (if any).}
\item{hessian}{Hessian matrix (only if \code{hessian = TRUE}).}
}
}
\description{
Fit a HawkesNet model by maximum likelihood
}
\examples{
set.seed(1)

params_true <- list(
  mu = 0.5,
  K = 0.5,
  beta = 0.5,
  beta_edges = 2
)

sim <- sim_hawkesNet(
  params = params_true,
  T_end = 10,
  mark_type = "ba"
)

params_init <- list(
  mu = 1,
  K = 1,
  beta = 1,
  beta_edges = 1
)

fit <- fit_hawkesNet(
  events = sim$ev,
  params_init = params_init,
  mark_type = "ba"
)

fit$par

}
