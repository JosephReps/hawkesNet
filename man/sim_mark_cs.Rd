% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sim_cs.R
\name{sim_mark_cs}
\alias{sim_mark_cs}
\title{Simulate CS mark (arrivals + edges) for one event}
\usage{
sim_mark_cs(
  net,
  t_k,
  params,
  formula_rhs,
  truncation = Inf,
  max_node_time = Inf,
  model_cache = NULL,
  new_nodes = NULL,
  eps = 1e-12
)
}
\arguments{
\item{net}{Pre-event network state (network::network).}

\item{t_k}{Numeric scalar event time.}

\item{params}{List with beta_edges, node_lambda, and CS_* parameters.}

\item{formula_rhs}{RHS string for ERNM change stats, e.g. "edges + triangles".}

\item{truncation}{integer >= 1 or Inf; deterministic candidate set size per new node.}

\item{max_node_time}{numeric scalar; if t_k > max_node_time, set arrivals=0.}

\item{model_cache}{optional cache (list) holding ERNM model; passed through to edge_probs_cs().}

\item{new_nodes}{optional character vector to force the arriving node ids (tests).}

\item{eps}{numeric in (0,0.5) for probability clamping.}
}
\value{
list(arrivals = data.frame(id=...), edges = data.frame(i,j))
}
\description{
For one accepted event time t_k:
1) Sample number of arrivals M ~ Pois(node_lambda) if t_k <= max_node_time, else M=0.
2) Add M new nodes (conceptually; we augment a copy for change-stats).
3) For each new node u, consider candidate edges to old nodes v (deterministic truncation).
4) Sample each candidate edge independently with probability p_uv from edge_probs_cs().
}
